'use client';

import React, {useEffect, useState} from 'react';

import styles from './BackTopTop.module.scss';

declare const window: any;

const BackToTop = () => {
  const [isVisible, setIsVisible] = useState(false);

  // Check scroll position
  const toggleVisibility = () => {
    let offSet = window.innerHeight / 2;

    // Special case on services page
    if (window.location.pathname === '/services') {
      offSet = 1200;
    }

    if (window.pageYOffset >= offSet) {
      setIsVisible(true);
    } else {
      setIsVisible(false);
    }
  };

  useEffect(() => {
    toggleVisibility();
    window.addEventListener('scroll', toggleVisibility);
    return () => {
      window.removeEventListener('scroll', toggleVisibility);
    };
  }, []);

  // Scroll to top function
  const scrollToTop = () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth',
    });
  };

  return (
      <div
          className={`${styles.moduleWrapper} hidden 768:flex fixed bottom-[30px] right-0 z-[1000]`}>
        <button
            onClick={scrollToTop}
            className={`bg-icon bg-opacity-[0.8] hover:bg-opacity-[1] text-white transition-all duration-500 ease-in-out ${isVisible ?
                'opacity-100' :
                'opacity-0'}`}
        >
          <div className="desktopHeadingH6">Back to top</div>
          <svg className="rotate-180 h-[30px] w-[30px]" width="81" height="93" viewBox="0 0 81 93" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M0.00408047 79.3715V74.9871C0.146897 74.9445 0.133295 74.8238 0.138736 74.7126C0.216265 73.2841 0.535902 71.8953 1.0106 70.5628C2.47413 66.4556 4.00566 62.3717 5.49775 58.2741C6.7763 54.7638 8.03172 51.2439 9.30755 47.7323C10.3821 44.7736 11.4729 41.8205 12.5529 38.8646C14.0055 34.8905 15.4541 30.9164 16.9081 26.9436C18.2479 23.2824 19.5903 19.6225 20.9342 15.9627C22.4916 11.7168 24.5359 7.78252 27.9145 4.67843C29.5385 3.18676 31.3707 2.056 33.4136 1.26283C36.0088 0.254204 38.6965 -0.0902379 41.4712 0.0195443C43.7576 0.111487 45.9502 0.567083 48.0448 1.47416C50.6087 2.5857 52.785 4.21597 54.6701 6.31418C56.8273 8.71292 58.3004 11.4863 59.4008 14.4765C60.614 17.7741 61.7416 21.1046 62.8732 24.4324C64.2919 28.6013 65.8166 32.7305 67.1754 36.9228C68.5274 41.0932 69.995 45.2251 71.4844 49.3474C72.5072 52.1771 73.492 55.0204 74.4767 57.8638C75.3799 60.467 76.3334 63.0537 77.2365 65.6569C78.4511 69.1563 79.8439 72.6007 80.1772 76.358C80.3689 78.5207 80.101 80.6052 79.4223 82.6348C78.564 85.1995 77.0801 87.3485 74.9596 89.0282C72.4011 91.0537 69.553 92.3491 66.26 92.5152C66.0791 92.5248 65.8438 92.4054 65.7228 92.6647H64.636C64.6006 92.5193 64.4823 92.5165 64.3708 92.5179C62.9589 92.5385 61.6301 92.1844 60.3093 91.7041C57.3918 90.642 55.0469 88.832 53.227 86.318C51.3772 83.7628 50.2075 80.8906 49.4186 77.8469C49.1397 76.7697 49.1343 76.771 48.0271 76.771C44.4744 76.771 40.923 76.771 37.3703 76.771C35.243 76.771 33.1157 76.7875 30.9898 76.7587C30.5192 76.7518 30.3097 76.8959 30.1819 77.346C29.9262 78.2503 29.6215 79.141 29.325 80.0329C28.2246 83.3442 26.6495 86.3564 24.0517 88.7551C22.0318 90.62 19.7658 91.9608 17.0278 92.393C16.8564 92.4205 16.7231 92.4699 16.7014 92.6675H13.4424C13.4043 92.5234 13.2846 92.533 13.1758 92.522C12.119 92.4246 11.0934 92.2091 10.0883 91.8386C7.63456 90.9343 5.50455 89.5456 3.74859 87.5969C2.38299 86.0833 1.38872 84.346 0.734485 82.3974C0.401246 81.4052 0.319637 80.3636 0 79.3756L0.00408047 79.3715ZM40.1097 57.448C41.58 57.448 43.0517 57.4535 44.522 57.4452C45.1994 57.4411 45.874 57.4754 46.5486 57.33C49.201 56.7564 50.7583 53.8211 50.0551 51.7324C49.5927 50.3574 49.356 48.9028 49.0609 47.4743C48.5358 44.9314 47.8285 42.4298 47.4273 39.8581C47.1702 38.2073 46.1882 37.0601 44.6988 36.341C44.3615 36.1777 44.1248 36.1749 43.8038 36.4549C42.8477 37.292 41.8289 38.0563 40.855 38.8728C40.5095 39.1624 40.2606 39.2077 39.8716 38.9017C38.8025 38.0591 37.6763 37.2892 36.6032 36.4521C36.2863 36.2051 36.0428 36.1694 35.6946 36.3369C34.2555 37.0312 33.3266 38.1373 32.9811 39.7154C32.8791 40.1806 32.86 40.665 32.7512 41.1289C31.8753 44.856 30.9912 48.5817 30.0975 52.3033C30.0091 52.6711 30.0051 53.0238 30.069 53.386C30.4906 55.8012 32.3812 57.426 34.8132 57.4439C36.5787 57.4562 38.3442 57.4466 40.1083 57.4466L40.1097 57.448ZM40.2661 21.8223C36.6249 21.8223 33.672 24.807 33.6788 28.4833C33.6843 32.1253 36.6236 35.1004 40.2294 35.1128C43.8773 35.1265 46.8424 32.1583 46.8492 28.4861C46.856 24.807 43.9072 21.8223 40.2661 21.8223Z"
                fill="white"/>
          </svg>
        </button>
      </div>
  );
};

export default BackToTop;
